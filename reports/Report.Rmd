---
title: "Project Data Management and Exploratory Data Analysis "
author: "Filippos Pikrides"
date: "14/11/2021"
output: pdf_document
---

```{r setup, include=FALSE}
# Knitr setup
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir= normalizePath('..'))
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```


```{r include=FALSE}
# Load project
library("ProjectTemplate")
setwd("~/R/CSCFilProject")
load.project()

# Run code in analysis.R script
source("src/Analysis.R")
```


## Introduction

**Analysis of the FutureLearn course **   
 FutureLearn courses are consist of several courses that can be attended by people all over the word and cover interested topics.  Some online activities are related with the secure payments. This methodology of learning might need continuous feedback in order to continue to enroll new learners. Tools to analyse and discover different area that may give value to the company, are always helpful. The "FutureLearn MOOC Dataset" is based on several files on CSV   format.
 
   
## Business Undertanding
 The main business objective of the analysis was to uncover important  factors and to reveal indicators that will keep the enrollments in growth rate. Seminars must always be interesting from all the learners. Everyone's approach to learning is based on a complex mix of strengths and preferences. Part of the analysis, is to predict these preferences and apply new material and activities at different time. The continuous observations of trends may need to change  some strategic plans  for the sustainability of the company. By applying  data mining  goals is used to discover patterns and relationships in the data in order to help make better business decisions. The main goal of the business is to  increase revenues, cut costs, improve customer relationships and  reduce risks.  
 

## Data Undertading
 The initial analysis is based mainly on the 4th set of data. Basic target of this analysis was to understand the content of the files and how they related. How these data are fit with the FutureLearn courses. After a detail analysis of the 4th set of data files then a merging of many sets of data from the 2nd 3rd and 4th run of files, more statistical information's can be extracted, as I analyse bigger and  historical data about the course.
 During the analysis the demographics data of the learners  might help us to take some conclusions and actions about the course. Part of this analysis was the age of people that participated in the course as well their origin country. Education Level and employments area are part of the analysis. Important part of the analysis was to find an indicator as to how engaged the learner is, and subsequently how likely they might be to drop out.
 
## Data Preparation
One important part of the analysis was the data preparation. Many records in a data files in enrollment were missed information's like age, gender, country, education. These data are important to have detail and precise analysis. A cleansing procedure is taking place during the loading of data. Some other fields need to be formatted in proper format in order to be ready for analysis. Such fields are mainly the dates where needed  conversion from string to date format. For some analysis, the merging and the join of different files as week from different sets of data took place. With this merge I can join the characteristics of learners with their activities.


## Data Analysis - Reports   
The initial   analysis is based mainly on the 4th set of data. The  4th set of data consist of the below category of data files:
 
 * **Enrollment**
 * **Activity**
 * **Question Response**
 * **Leaving the course**
 * **Videos**

## Report 1     AgeRange Vs Gender 
This graph shows the enrollments regarding the Age range and  the gender of the learners from the 4th set of data. People from both genders are likely to attend the course. The data shows that  from  age 18-25 and 26-35 are interested more in attending this course. Male are interested more than females. 
From this analysis, they have find out that many learners have not update these fields. For better and more accurate analysis, these fields must be compulsory during the enrollments of users.

```{r}
   
  ga = ggplot(dfenrolment4, aes(x=age, y=n, group=gender)) +
  geom_line(aes(color=gender))+
  geom_point(aes(color=gender)) +
  labs(title = "Enrolments regarding age/gender", x = "Age-Range", y = "Number of Ocurances")
  print(ga)
  
```
##############################################################################################################################

## Report 2   Age vs EducationLevel
This graph shows   the education level  per age of the leaner.  Inside of every circle there is a number of learners who attend the course. Each age range has different color circle. The age with the highest count from university degree and university masters is the age 26-35. Based on university degree and university masters the age 36-45 is the second highest with the count of people 28 and 21.The age 18-25 also has a lot people in secondary with count 38 and university degree with count 36.The age >65 has the highest count of people in university doctorate and professional. The age <18 has the lowest count of people in secondary which is normal at this age. From the graph it's clear that most people are related with Technology. This is because may be more easily accessible to these people due to the knowledge of technology. One Point that I extract from this gap was to advertise this course to be known from more people.  

```{r}
##graph of age vs highest_education_level
ggplot(data=dfageeducation4) + geom_point(aes(x=age , y=education  ,colour=age, size = 4 ))+
  geom_text(aes(x=age,label = n,y=education), size = 3)+
  labs(title = "Education per Age",
       x = "Age-Range",
       y = "Highest Education Level")
```
##############################################################################################################################

## Report 3  Employment area of learners
This Pie chart shows the top 5 employment areas based on the data. Each color represents the employment's job. The ration from around from pie chart starts by 50. The first biggest employment area is the IT and Information services with number of people 97.Unfortunately the second employment's job is **unknown** .  It counts 93  people  from the 4th set. The teaching and education is the third highest job with 32 number of people. It will be nice to be compulsory for learners to fulfill this information, using a drop down option during their enrollment. 

```{r}
##group the employment_area
dfemployment4pie <- enrolment4 %>%
dplyr::count( employment=enrolment4$employment_area, sort = TRUE) 
## keep the top 5 
dfemployment4pie <- head(dfemployment4pie,5)
## plot the top 5 employment area in Pie
ggplot(dfemployment4pie, aes(x = "", y = n, fill = employment)) +
  geom_col(color = "black") +
  geom_text(aes(label = n),
            position = position_stack(vjust = 0.5)) +
  coord_polar(theta = "y")
```
##############################################################################################################################

## Report 4      Enrolments by gender vs country
On this graph, Bar Chart shows us by gender top countries that are participating in the course. It is amazing the participation from so many countries that are interested in the course. These data are displayed after cleansing of data.  

```{r}
  ggplot(dfcountry4 ,aes(x = gender, y = n   , fill = country))+
  geom_bar(stat="identity")+
  # geom_text(aes(label = n), size = 3) +
  labs(title = "Enrolments regarding gender Country",
       x = "Gender",
       y = "Number of Ocurances")


```
##############################################################################################################################

## Report 5   Top Detected countries  that participating in the course 
On this Bar Chart shows us the number of the enrollments based on the top detected countries that participating in the course. The y axis is increased by 300 and each color represents the countries. Clearly that GB has the highest number of enrollments 1079. Secondly comes the IN with 347 and thirdly EG with 279. What is important from this analysis, is the interest of attending this course all over the world. So an advertisement over the internet would be interesting of attracting new learners. 

```{r}
## plot showing the top countries regarding that participating in the course
ggplot(dfcountry4CY ,aes(x = country    , y = n   , fill = country))+
geom_bar(stat="identity")+
 geom_text(aes(label = n), size = 3) +
 labs(title = "Enrolments regarding Detected country",
       x = "country",
       y = "Number of  Enrollments")

```
##############################################################################################################################



**Activity file**  
The  course mainly consist of 3 sections. Each section has many activities that a learner need to attend and pass some questions. From this data file, useful informationâ€™s regarding numbers and the total trials of the learners can be extracted. Information like the average time for completion of each section is extracted. Having learners that their duration is more than the average time, as a possible solution we can send them a reminder or questionnaire for helping them to complete the course.

## Report 6   Activities on the 3 Sections 
Based on this graph shows us the number of activities from the learners based on the sections.The first section with a variety of activities has the highest numbe with totals of  25722  with the second section with 16941 and the third with number 11861. From these numbers, I can see how active is the activities sessions and if it needs any improvement in case of accessibility. 

```{r}
## plot showing the number of trials in the 3 sections of activities
ggplot(dfsteps4 ,aes(x = stepcount     , y = n   , fill = stepcount        ))+
  geom_bar(stat="identity")+
  geom_text(aes(label = n,y=n), size = 3) +
  labs(title = "Section  Activity",
       x = "Sections of  Steps ",
       y = "Number of Activities")
```
##############################################################################################################################   

The result of this below graph is the same with the above graph the difference between them is that in the analysis it has been used in different ggplot to show the section activity with Number of Activities on y axis and Sections of Steps on x axis. 


```{r}
g = ggplot(data=dfsteps44, aes(x=step, y=n))
g1 = g + geom_point() + stat_smooth(linetype=2) +
  xlab("Sections of  Steps") + ylab("Number of ativiries")
print(g1)
```
##############################################################################################################################


## Report 7  Step duration  for the activities
This graph shows us the duration of each step. The y axis shows the minutes and starts by 200 minutes and the x axis shows the steps set. Based on the graph the step 1 took more minutes to be completed than the other steps. The step 2 took 464 minutes which has the fewest minutes comparing with other two steps 1 and 3. 

```{r}
## plot showing the average time for each section to be completed 
ggplot(dfstepdurationinmin ,aes(x = step     , y = name  ,fill=step      ))+
  geom_bar(stat="identity")+
  geom_text(aes(x = step , label =name, y=name), size = 3) +
  labs(title = "Steps Duration",
       x = "Steps set ",
       y = "minutes")
```
##############################################################################################################################


**Question Response File**    
This category of file is also important because from the response of the quiz's, you can get an indication how easy or difficult are some questions. It will also see if the people can understand the topic of the activities.

## Report 8     Quiz Response 
Analysis of data regarding the questions vs response
This graph shows us on each quiz section the true and the false answers for the quiz. The red color represents the false and the blue the true. On the first quiz section there are more true answers than false which is pretty good overall for this first quiz section. On the second quiz section there are more true than false answers but the range between them is small comparing with the first step. Unfortunately the third step has more false answers than true. This may give  an alert that may change some topics
```{r}
## group my data per section and response : correct/false answers 
dfQuestionresp4 <- Questionresp4 %>%
dplyr::count(quiz= str_sub(Questionresp4$quiz_question, 1, 1),response=Questionresp4$correct, sort = TRUE) 
## plot showing the correct/false answers per section 
ggplot(data=dfQuestionresp4) + geom_point(aes(x=quiz  , y=n  ,colour=response, size = 4 ))+
  geom_text(aes(x=quiz ,label = n,y=n    ), size = 3)+
  labs(title = "Question/Response Quiz",  x = "Quiz-Section ", y = "Number of Trialsl")
```
##############################################################################################################################

## Report 9    Age Vs Quiz response for failure response
 
This Bar Chart shows the incorrect answers per age.The y axis shows  the number of incorrect answers and starting by 100. The x axis shows the age range of the people. The age 56-65 and >65 has the highest numbers of incorrect answers. It's important to mention that the age <18 has the lowest incorrect answers with only 5 in all ages. From this statistic information, we could think of enrich some activities or produce some new videos  in order to be more undertandable from older age.

```{r}
## group the set of wrong answers by Age
dfQuestionrespFalse <- DF_QuestionAnswerJoin %>%
dplyr::count(Age=  DF_QuestionAnswerJoin$age_range , sort = TRUE)
## plot the worong answer per age 
ggplot(dfQuestionrespFalse ,aes(x = Age     , y = n  ,fill=Age      ))+
  geom_bar(stat="identity")+
  geom_text(aes(x = Age , label =n, y=n), size = 3) +
  labs(title = "Incorrect answerd Per Age  ", x = "Age Range ",  y = "No. Incorrect answers")
```
##############################################################################################################################




## Report 10  Providing students with better feedback on their progress
**Leaving Reason File**  
This kind of information is important because it gives a feedback of people who leaving the course. Their opinion is always countable.

```{r}
ggplot(dfleavingReason4 ,aes(x = LeftYear, y = reason  , fill = LeftYear , colour= LeftYear,size = 3   ))+
  #  geom_bar(stat="identity")+
  geom_text(aes(x=LeftYear,label = n,y=reason), size = 3) +
  labs(title = "Leaving Reason from Course",
       x = "Year Left",
       y = "Reason")
```
##############################################################################################################################
**Analysis with merging many files**   
After the analysis of the 4th set,  by merging many files from different sets of data we can explore and extract historical statistical informations.The **trend of enrollments** by year and  by month is an indication of the success of the course. According to the trend, actions may need to be taken. Another finding is the **average duration** of the course that  can be extracted. The history of the data files help us to have more precise results in some analysis.

## Report 11  Enrolments Per Year    

On below ggplot a multiple files have been used which are the Enrollments.csv from the second, third and forth run of files.
This graphs gives us the trend of enrollment between three years. It is important for the course to see if people are interested in attending the course in order to take actions.

```{r}
ggplot(dfenrolments ,aes(x = Enrolemts    , y = n   , fill = Enrolemts   ))+
  geom_bar(stat="identity")+
  geom_text(aes(label = n,y=n), size = 3) +
  labs(title = "Enrolments By Year", x = "Year", y = "Number of Enrolments")
```

The trend of enrollments  can be analysed also per Month. 

```{r}
library(knitr)
kable(table(data2017$enrolled_at),caption = "Enrolments per month for 2017")
```
##############################################################################################################################


## Report 12   Duration of Enrolments 
Average duration of the course. 
```{r}
kable(head(dfdataenroldurationall),caption="Average duration of the course")
```

It is also important to know from the historical data, how many learners are active. The current activity of each user and also number of user in each activities will be a useful information.
 

```{r}
kable(nrow(dataAllenrolments),caption="Number of Active Learners")
```


##  Comparison of two cycles, the  4th and 5th cycle
 
**Trend of new learners**  
Comparing 2 cycles I want to see the trend of new learners. Based on the below table I see that I have fewer learners in the 5th run.
If the downward trend continue, then a decision for marketing campaign may needed for the FutureLearn.

```{r}
kable(nrow(Activelearners4),caption="Number of New  Learners of 4th run")
```
```{r}
kable(nrow(Activelearners5),caption="Number of New  Learners of 5th run")
```

**Leaving course**  
Comparing the learners leaving from the course I see that more people are leaving in 5th run. This gives an alert message to the FutureLearn to take action by analyzing the reason of leaving.

```{r}
kable(nrow(leaving4),caption="No of Learners leaving the course in the 4th run")
```
```{r}
kable(nrow(leaving5),caption="No of Learners leaving the course in the  5th run")
```

Leaving Reason is a useful feedback, because it gives you an assessment from the learners about the course. It would be an indication of enrich the content of activities or change the topic in some cases.

```{r}
kable(table(leaving5$leaving_reason),caption="Leaving Reason of the  5th run")
```


## Modeling 
By applying model fitting in some variables, I can extract useful information's. These information's may related with the trend of new enrollments as well the quality of the seminars. This kind of information can help to uncover hidden information's and take some important actions for the good of the FutureLearn.  
In the below analysis, I try to apply the Linear model fitting and predict some enrollments based on the variables  age, gender and  country. 

```{r}
## plot the graph of regression fit 
plot(x = modelenrolment4$enrolled_at,             # True values on x-axis
     y = results.lm$fitted.values,               # fitted values on y-axis
     xlab = "True Values",
     ylab = "Model Fitted Values",
     main = "Regression fits of new enrolments")

abline(b = 1, a = 0)
```


## Evaluation
The findings from the analysis gives some guidelines how the course program may be more interesting and have more new learners. Having an estimation of the **duration of activity**  and the **course duration**, this will gives an alert message to give more motivation or reminder to learner to attend the course.  
Another finding is the **bigger failure** of activities in **older ages**. This will give a message to FutureLearn to revise, enrich and reosrganise some topics in activities in order to help the older people to attend the course. FutureLearn is interested having learners in this age.    
Analysis of **leaving  reason** from some learners, will rethink some strategies plans of the FutureLearn.  
Finally by applying model fittings in some fields , we can extract some useful predictions  about the **countries** that may be  interested in attending the course.




